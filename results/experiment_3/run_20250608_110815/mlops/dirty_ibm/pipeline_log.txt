Starting MLOps Pipeline for source: dirty_ibm at 2025-06-08T11:08:18.623020
Output Directory: results/experiment_3/run_20250608_110815/mlops/dirty_ibm
Evaluate Only: False
Detect Drift: True
Reference Data Path (for drift): data/ibm_dataset.csv
Reference Artifacts Directory: results/experiment_1/latest_artifacts/mlops/ibm
Retrain on Drift: True

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/01_data_acquirer.py --input_file /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/../data/ibm_dataset_dirty.csv --output_file results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01_dirty_ibm_acquired_data.csv
--- Starting Step 1: Data Loading ---
Loading data from /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/../data/ibm_dataset_dirty.csv...
Initial dataset shape: (1514, 35)
Checking for missing values...
585
Checking for duplicate rows...
1
Saving data to results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01_dirty_ibm_acquired_data.csv...
--- Finished Step 1: Data Loading ---
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/01b_drift_detector.py --current_data results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01_dirty_ibm_acquired_data.csv --output_report results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01b_drift_report.html --drift_status_file results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01b_drift_status.json
Drift analysis complete. Report: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01b_drift_report.html
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/02a_preprocessorIBM.py --input_file results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01_dirty_ibm_acquired_data.csv --output_file results/experiment_3/run_20250608_110815/mlops/dirty_ibm/02_dirty_ibm_preprocessed_data.csv
--- Starting Step 2: Pre-processing IBM dataset ---
Input file: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01_dirty_ibm_acquired_data.csv
Output file: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/02_dirty_ibm_preprocessed_data.csv
Preprocessor artifact path: artifacts/IBM_preprocessor.pkl
Loading data from results/experiment_3/run_20250608_110815/mlops/dirty_ibm/01_dirty_ibm_acquired_data.csv...
Removed columns: ['YearsWithCurrManager', 'TrainingTimesLastYear', 'StockOptionLevel', 'StandardHours', 'RelationshipSatisfaction', 'PercentSalaryHike', 'Over18', 'NumCompaniesWorked', 'MonthlyRate', 'HourlyRate', 'EmployeeCount', 'EducationField', 'Education', 'DailyRate', 'BusinessTravel', 'JobRole']
Replaced 'Research & Development' with 'Other' in 'Department' column.
Numerical features (13): ['Age', 'DistanceFromHome', 'EmployeeNumber', 'EnvironmentSatisfaction', 'JobInvolvement', 'JobLevel', 'JobSatisfaction', 'PerformanceRating', 'TotalWorkingYears', 'WorkLifeBalance', 'YearsAtCompany', 'YearsInCurrentRole', 'YearsSinceLastPromotion']
Categorical features (5): ['Department', 'Gender', 'MaritalStatus', 'MonthlyIncome', 'OverTime']
Checking for missing values... 585
Filled 0 missing values in 'EnvironmentSatisfaction' with median: 3.0
Filled 0 missing values in 'JobSatisfaction' with median: 3.0
Filled 0 missing values in 'WorkLifeBalance' with median: 3.0
Filled missing 'MonthlyIncome' with median (6210.625) before binning.
Categorized 'MonthlyIncome' into 10 bins (1-10).
Saving data to results/experiment_3/run_20250608_110815/mlops/dirty_ibm/02_dirty_ibm_preprocessed_data.csv...
Processed data shape: (1514, 18)
Processed data saved to: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/02_dirty_ibm_preprocessed_data.csv
Saving data to results/experiment_3/run_20250608_110815/mlops/dirty_ibm/02_dirty_ibm_preprocessed_data.csv...
Final processed data saved to: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/02_dirty_ibm_preprocessed_data.csv
--- Finished Step 2: Pre-processing ---
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/03_feature_engineer.py --input_file results/experiment_3/run_20250608_110815/mlops/dirty_ibm/02_dirty_ibm_preprocessed_data.csv --output_file results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv --feature_selector_path results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/feature_selector.pkl --expected_cols_path results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/expected_cols.json
--- Starting Step 3: Feature Engineering ---
Loading data from results/experiment_3/run_20250608_110815/mlops/dirty_ibm/02_dirty_ibm_preprocessed_data.csv...
One-hot encoding categorical columns: ['Department', 'Gender', 'MaritalStatus', 'OverTime']
Shape after one-hot encoding: (1514, 52)
Handling column standardization. Training mode for expected_cols.json: True.
Current feature columns (post-OHE) saved to results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/expected_cols.json.
Shape after handle_missing_columns: (1514, 52)
Creating new features...
PCA explained variance ratio: [0.24489065 0.11504488 0.08224656]
Shape after create_new_features: (1514, 57)
Saving data to results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv...
Engineered data shape: (1514, 58)
--- Finished Step 3: Feature Engineering ---
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/04_model_trainer.py --input_file results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv --output_dir results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts
Loading data from: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv
Saving artifacts to: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts
Calculated scale_pos_weight: 5.219178082191781

Applying SMOTE to balance classes in training data...
Original class distribution in training data: [1028  197]
Class distribution after SMOTE: [1028 1028]
Fitting 10 folds for each of 10 candidates, totalling 100 fits
/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/xgboost/sklearn.py:1395: UserWarning: `use_label_encoder` is deprecated in 1.7.0.
  warnings.warn("`use_label_encoder` is deprecated in 1.7.0.")
/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/xgboost/sklearn.py:835: UserWarning: `early_stopping_rounds` in `fit` method is deprecated for better compatibility with scikit-learn, use `early_stopping_rounds` in constructor or`set_params` instead.
  warnings.warn(
Best hyperparameters found:
{'colsample_bytree': 0.9868777594207296, 'gamma': 0.23277134043030423, 'learning_rate': 0.03718193035984624, 'max_depth': 8, 'min_child_weight': 3, 'n_estimators': 975, 'reg_alpha': 0.5142344384136116, 'reg_lambda': 0.5924145688620425, 'subsample': 0.5232252063599989}
Best CV F1: 0.4281

F1 scores for each fold with best hyperparameters:
  fold_1: Test F1 = 0.2963, Train F1 = 0.9871
  fold_2: Test F1 = 0.4375, Train F1 = 0.9872
  fold_3: Test F1 = 0.5161, Train F1 = 0.9821
  fold_4: Test F1 = 0.3000, Train F1 = 0.9897
  fold_5: Test F1 = 0.3871, Train F1 = 0.9897
  fold_6: Test F1 = 0.4000, Train F1 = 0.9794
  fold_7: Test F1 = 0.4211, Train F1 = 0.9819
  fold_8: Test F1 = 0.5556, Train F1 = 0.9846
  fold_9: Test F1 = 0.5556, Train F1 = 0.9898
  fold_10: Test F1 = 0.4118, Train F1 = 0.9898

Calculating performance metrics across data splits...
Training metrics:
  Accuracy:  0.8678
  Precision: 0.7692
  Recall:    0.2538
  F1-Score:  0.3817
  AUC:       0.8845
Validation metrics:
  Accuracy:  0.8540
  Precision: 0.6667
  Recall:    0.1818
  F1-Score:  0.2857
  AUC:       0.7632
Train+Validation metrics:
  Accuracy:  0.8664
  Precision: 0.7606
  Recall:    0.2466
  F1-Score:  0.3724
  AUC:       0.8721
Test (hold-out) metrics:
  Accuracy:  0.8553
  Precision: 0.5500
  Recall:    0.4583
  F1-Score:  0.5000
  AUC:       0.7687

Training and validation metrics saved to results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/training_metrics.json
Model training complete. Artifacts saved under 'results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts'.
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/05_model_evaluator.py --input_file results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv --model_path results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/model.pkl --output_dir results/experiment_3/run_20250608_110815/mlops/dirty_ibm
Loading data from: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv
Splitting data into train/test to isolate the hold-out test set...
Test set shape: X_test (152, 56), y_test (152,)
Loading scaler from: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/scaler.pkl
Applying scaling to numeric columns: ['Age', 'DistanceFromHome', 'EnvironmentSatisfaction', 'JobInvolvement', 'JobLevel', 'JobSatisfaction', 'MonthlyIncome', 'PerformanceRating', 'TotalWorkingYears', 'WorkLifeBalance', 'YearsAtCompany', 'YearsInCurrentRole', 'YearsSinceLastPromotion', 'StagnationScore', 'TenureRatio', 'PCA1', 'PCA2', 'PCA3']
Loading model from: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/model.pkl
Computing point estimates...
Saved predictions to results/experiment_3/run_20250608_110815/mlops/dirty_ibm/y_pred.npy
Saved true labels to results/experiment_3/run_20250608_110815/mlops/dirty_ibm/y_true.npy
Point estimates on the hold-out test set:
  AUC:       0.8480
  Accuracy:  0.8421
  Precision: 0.5000
  Recall:    0.1667
  F1‐Score:  0.2500

Computing fairness metrics...
  Demographic Parity Difference (Gender): 0.0170
  Equalized Odds Difference (Gender):     0.0571
  Demographic Parity Difference (Age Binned): 0.2381
  Equalized Odds Difference (Age Binned):     0.3333

Computing bootstrap confidence intervals...

95% Bootstrap confidence intervals (n_boot=1000):
  AUC CI:       [0.7726, 0.9148]
  Accuracy CI:  [0.7829, 0.9013]
  Precision CI: [0.1429, 0.8576]
  Recall CI:    [0.0385, 0.3200]
  F1‐Score CI:  [0.0645, 0.4324]

Evaluation summary saved to: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/evaluation_summary.json
--- Finished Step 5: Model Evaluation ---
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/../monitoring/performance_tracker.py --model_path results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/model.pkl --reference_data results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv --output_dir results/experiment_3/run_20250608_110815/mlops/dirty_ibm
Tracking model performance on results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv
Loading object from results/experiment_3/run_20250608_110815/mlops/dirty_ibm/artifacts/model.pkl...
Loading data from results/experiment_3/run_20250608_110815/mlops/dirty_ibm/03_dirty_ibm_engineered_features.csv...
Traceback (most recent call last):
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/../monitoring/performance_tracker.py", line 103, in <module>
    track_model_performance(args.model_path, args.reference_data, args.output_dir, args.threshold)
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/../monitoring/performance_tracker.py", line 42, in track_model_performance
    y_pred_proba = model.predict_proba(X)[:, 1]
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/xgboost/sklearn.py", line 1606, in predict_proba
    class_probs = super().predict(
                  ^^^^^^^^^^^^^^^^
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/xgboost/sklearn.py", line 1114, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/xgboost/core.py", line 2269, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 56, got 57
Finished with exit code: 1


Pipeline finished at 2025-06-08T11:08:49.246637
Total pipeline duration: 0 days 00:00:30.623617
Resource usage logged to: results/experiment_3/run_20250608_110815/mlops/dirty_ibm/resource_usage.csv
