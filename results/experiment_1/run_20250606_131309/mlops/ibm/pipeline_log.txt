Starting MLOps Pipeline for source: ibm at 2025-06-06T13:16:01.608204
Output Directory: results/experiment_1/run_20250606_131309/mlops/ibm
Evaluate Only: False
Detect Drift: False
Reference Data Path (for drift): None
Reference Artifacts Directory: None
Retrain on Drift: True

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/01_data_acquirer.py --input_file /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/../data/ibm_dataset.csv --output_file results/experiment_1/run_20250606_131309/mlops/ibm/01_ibm_acquired_data.csv
--- Starting Step 1: Data Loading ---
Loading data from /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/../data/ibm_dataset.csv...
Initial dataset shape: (1470, 35)
Checking for missing values...
0
Checking for duplicate rows...
0
Saving data to results/experiment_1/run_20250606_131309/mlops/ibm/01_ibm_acquired_data.csv...
--- Finished Step 1: Data Loading ---
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/02a_preprocessorIBM.py --input_file results/experiment_1/run_20250606_131309/mlops/ibm/01_ibm_acquired_data.csv --output_file results/experiment_1/run_20250606_131309/mlops/ibm/02_ibm_preprocessed_data.csv
--- Starting Step 2: Pre-processing IBM dataset ---
Input file: results/experiment_1/run_20250606_131309/mlops/ibm/01_ibm_acquired_data.csv
Output file: results/experiment_1/run_20250606_131309/mlops/ibm/02_ibm_preprocessed_data.csv
Preprocessor artifact path: artifacts/IBM_preprocessor.pkl
Loading data from results/experiment_1/run_20250606_131309/mlops/ibm/01_ibm_acquired_data.csv...
Replaced 'Research & Development' with 'Other' in 'Department' column.
Numerical features (26): ['Age', 'DailyRate', 'DistanceFromHome', 'Education', 'EmployeeCount', 'EmployeeNumber', 'EnvironmentSatisfaction', 'HourlyRate', 'JobInvolvement', 'JobLevel', 'JobSatisfaction', 'MonthlyIncome', 'MonthlyRate', 'NumCompaniesWorked', 'PercentSalaryHike', 'PerformanceRating', 'RelationshipSatisfaction', 'StandardHours', 'StockOptionLevel', 'TotalWorkingYears', 'TrainingTimesLastYear', 'WorkLifeBalance', 'YearsAtCompany', 'YearsInCurrentRole', 'YearsSinceLastPromotion', 'YearsWithCurrManager']
Categorical features (8): ['BusinessTravel', 'Department', 'EducationField', 'Gender', 'JobRole', 'MaritalStatus', 'Over18', 'OverTime']
Checking for missing values... 0
Categorized 'MonthlyIncome' into 10 bins (1-10).
Saving data to results/experiment_1/run_20250606_131309/mlops/ibm/02_ibm_preprocessed_data.csv...
Processed data shape: (1470, 34)
Processed data saved to: results/experiment_1/run_20250606_131309/mlops/ibm/02_ibm_preprocessed_data.csv
Saving data to results/experiment_1/run_20250606_131309/mlops/ibm/02_ibm_preprocessed_data.csv...
Final processed data saved to: results/experiment_1/run_20250606_131309/mlops/ibm/02_ibm_preprocessed_data.csv
--- Finished Step 2: Pre-processing ---
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/03_feature_engineer.py --input_file results/experiment_1/run_20250606_131309/mlops/ibm/02_ibm_preprocessed_data.csv --output_file results/experiment_1/run_20250606_131309/mlops/ibm/03_ibm_engineered_features.csv --feature_selector_path results/experiment_1/run_20250606_131309/mlops/ibm/artifacts/feature_selector.pkl --expected_cols_path results/experiment_1/run_20250606_131309/mlops/ibm/artifacts/expected_cols.json
--- Starting Step 3: Feature Engineering ---
Loading data from results/experiment_1/run_20250606_131309/mlops/ibm/02_ibm_preprocessed_data.csv...
One-hot encoding categorical columns: ['BusinessTravel', 'Department', 'EducationField', 'Gender', 'JobRole', 'MaritalStatus', 'Over18', 'OverTime']
Shape after one-hot encoding: (1470, 55)
Handling column standardization. Training mode for expected_cols.json: True.
Current feature columns (post-OHE) saved to results/experiment_1/run_20250606_131309/mlops/ibm/artifacts/expected_cols.json.
Shape after handle_missing_columns: (1470, 55)
Creating new features...
PCA explained variance ratio: [0.17978717 0.09677516 0.06874594]
Shape after create_new_features: (1470, 60)
Saving data to results/experiment_1/run_20250606_131309/mlops/ibm/03_ibm_engineered_features.csv...
Engineered data shape: (1470, 61)
--- Finished Step 3: Feature Engineering ---
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/04_model_trainer.py --input_file results/experiment_1/run_20250606_131309/mlops/ibm/03_ibm_engineered_features.csv --output_dir results/experiment_1/run_20250606_131309/mlops/ibm/artifacts
Loading data from: results/experiment_1/run_20250606_131309/mlops/ibm/03_ibm_engineered_features.csv
Saving artifacts to: results/experiment_1/run_20250606_131309/mlops/ibm/artifacts
Calculated scale_pos_weight: 5.211267605633803

Applying SMOTE to balance classes in training data...
Original class distribution in training data: [998 192]
Class distribution after SMOTE: [998 998]
Fitting 10 folds for each of 100 candidates, totalling 1000 fits
/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/xgboost/sklearn.py:1395: UserWarning: `use_label_encoder` is deprecated in 1.7.0.
  warnings.warn("`use_label_encoder` is deprecated in 1.7.0.")
/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/xgboost/sklearn.py:835: UserWarning: `early_stopping_rounds` in `fit` method is deprecated for better compatibility with scikit-learn, use `early_stopping_rounds` in constructor or`set_params` instead.
  warnings.warn(
Best hyperparameters found:
{'colsample_bytree': 0.677995742135993, 'gamma': 0.8942172628959257, 'learning_rate': 0.04862451948989317, 'max_depth': 4, 'min_child_weight': 9, 'n_estimators': 893, 'reg_alpha': 0.7994103989090426, 'reg_lambda': 0.6279003894909078, 'subsample': 0.540879515974436}
Best CV F1: 0.5212

F1 scores for each fold with best hyperparameters:
  fold_1: Test F1 = 0.3750, Train F1 = 0.8328
  fold_2: Test F1 = 0.5455, Train F1 = 0.8513
  fold_3: Test F1 = 0.3750, Train F1 = 0.8363
  fold_4: Test F1 = 0.7568, Train F1 = 0.8504
  fold_5: Test F1 = 0.6667, Train F1 = 0.8430
  fold_6: Test F1 = 0.5625, Train F1 = 0.8580
  fold_7: Test F1 = 0.7059, Train F1 = 0.8412
  fold_8: Test F1 = 0.2963, Train F1 = 0.8397
  fold_9: Test F1 = 0.5714, Train F1 = 0.8571
  fold_10: Test F1 = 0.3571, Train F1 = 0.8488

Calculating performance metrics across data splits...
Training metrics:
  Accuracy:  0.8529
  Precision: 0.6000
  Recall:    0.2656
  F1-Score:  0.3682
  AUC:       0.8455
Validation metrics:
  Accuracy:  0.8271
  Precision: 0.3333
  Recall:    0.0952
  F1-Score:  0.1481
  AUC:       0.6824
Train+Validation metrics:
  Accuracy:  0.8503
  Precision: 0.5824
  Recall:    0.2488
  F1-Score:  0.3487
  AUC:       0.8305
Test (hold-out) metrics:
  Accuracy:  0.8163
  Precision: 0.4211
  Recall:    0.3333
  F1-Score:  0.3721
  AUC:       0.7085

Training and validation metrics saved to results/experiment_1/run_20250606_131309/mlops/ibm/artifacts/training_metrics.json
Model training complete. Artifacts saved under 'results/experiment_1/run_20250606_131309/mlops/ibm/artifacts'.
Finished with exit code: 0

Executing: python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/05_model_evaluator.py --input_file results/experiment_1/run_20250606_131309/mlops/ibm/03_ibm_engineered_features.csv --model_path results/experiment_1/run_20250606_131309/mlops/ibm/artifacts/model.pkl --output_dir results/experiment_1/run_20250606_131309/mlops/ibm
Loading data from: results/experiment_1/run_20250606_131309/mlops/ibm/03_ibm_engineered_features.csv
Splitting data into train/test to isolate the hold-out test set...
Test set shape: X_test (147, 59), y_test (147,)
Loading scaler from: results/experiment_1/run_20250606_131309/mlops/ibm/artifacts/scaler.pkl
Applying scaling to numeric columns: ['Age', 'DistanceFromHome', 'EnvironmentSatisfaction', 'JobInvolvement', 'JobLevel', 'JobSatisfaction', 'MonthlyIncome', 'PerformanceRating', 'TotalWorkingYears', 'WorkLifeBalance', 'YearsAtCompany', 'YearsInCurrentRole', 'YearsSinceLastPromotion', 'StagnationScore', 'TenureRatio', 'PCA1', 'PCA2', 'PCA3', 'DailyRate', 'Education', 'EmployeeCount', 'HourlyRate', 'MonthlyRate', 'NumCompaniesWorked', 'PercentSalaryHike', 'RelationshipSatisfaction', 'StandardHours', 'StockOptionLevel', 'TrainingTimesLastYear', 'YearsWithCurrManager']
Traceback (most recent call last):
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/05_model_evaluator.py", line 127, in <module>
    X_test_scaled[numeric_cols] = scaler.transform(X_test[numeric_cols])
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 140, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/sklearn/preprocessing/_data.py", line 1004, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/sklearn/base.py", line 579, in _validate_data
    self._check_feature_names(X, reset=reset)
  File "/Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/.venv/lib/python3.11/site-packages/sklearn/base.py", line 506, in _check_feature_names
    raise ValueError(message)
ValueError: The feature names should match those that were passed during fit.
Feature names must be in the same order as they were in fit.

Finished with exit code: 1


PIPELINE FAILED: Script python /Users/baueteeling/Library/CloudStorage/OneDrive-Personal/ONEDRIVE/STUDIE/THESIS/AttritionMLOps/scripts/05_model_evaluator.py --input_file results/experiment_1/run_20250606_131309/mlops/ibm/03_ibm_engineered_features.csv --model_path results/experiment_1/run_20250606_131309/mlops/ibm/artifacts/model.pkl --output_dir results/experiment_1/run_20250606_131309/mlops/ibm failed with exit code 1. Check log: results/experiment_1/run_20250606_131309/mlops/ibm/pipeline_log.txt

Pipeline finished at 2025-06-06T13:18:50.670025
Total pipeline duration: 0 days 00:02:49.061821
Resource usage logged to: results/experiment_1/run_20250606_131309/mlops/ibm/resource_usage.csv
